<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>MAF: Computations on subgroups</title>
<link type="text/css" rel="StyleSheet" href="site.css">
<link rel="Start" type="text/html" href="MAF.html"> 
<link rel="Chapter" type="text/html" href="Preface.html" title="Introduction">
<link rel="Chapter" type="text/html" href="overview.html" title="An overview of MAF">
<link rel="Chapter" type="text/html" href="reference.html" title="MAF Reference">
<link rel="Chapter" type="text/html" href="MAF.html#tutorials" title="Tutorials">
<link rel="Chapter" type="text/html" href="MAF.html#appendices" title="Appendices">
<link rel="Copyright" type="text/html" href="copyright.html"> 
<link rel="Contents" type="text/html" href="MAF.html"> 

<link rel="Next" type="text/html" href="reference.html" title="MAF Reference">
<link rel="Prev" type="text/html" href="automata.html" title="Overview : Computations on whole groups or monoids">
<script type="text/javascript" language="Javascript" src="site.js">
</script>
</head>
<body onload="OnPageLoad()" onunload="OnPageUnload()">
<a href="MAF.html">MAF</a> : Computations on subgroups
<h2>MAF: Computations on subgroups</h2>
<h3>What are coset systems for?</h3>
<p><a href="automata.html">Computations on whole groups or monoids</a> described how to use MAF to try to solve the word problem for a group or monoid. However, one is frequently concerned with the properties of subgroups of a group. We may want to know what the structure of the subgroup  generated by a certain set of elements of the group is, and which members of the original group are actually members of it, and, for the elements that are not, whether two elements are in the same (right) coset of the subgroup. Having a solution to the word problem for the group is not enough to let us solve these problems. The coset membership problem is called the <dfn>generalised word problem</dfn>: subgroup membership is then just the special case of whether a word belongs to the same coset as the identity.  It is often the case that, even when the word problem for a group cannot be solved, the generalised word problem can be solved for some of its subgroups. Clearly if we can find any subgroup in which two words belong to distinct cosets the words represent different elements of the group. The generalised word problem can be investigated, for a particular group and subgroup, through the use of a <dfn>coset rewriting system</dfn>. Coset rewriting systems, which from now on we shall coset systems for short, are very similar to the monoid and group rewriting systems we have been dealing with up until now.</p>
<h3>What is different about coset systems?</h3>
<p>The main differences between using MAF to perform computations on a subgroup with a coset system, and using it to perform computations on a whole group or monoid with an ordinary input file (which we should here think of as a rewriting system), lie, from the MAF user's point of view, in how the input file for a coset system is created, and in how <tt>automata</tt>, and the other MAF components that can deal with coset systems are then invoked.</p>
<p>The input file for a coset system is not created by the user directly. Instead it is created by MAF itself, using an input file for the group <i>G</i>  containing the subgroup, and a second input file in a new format, also created by the user, which is called a <dfn>substructure file</dfn>. The substructure file specifies the generators of the subgroup as words in the group generators, and, optionally, may also give them names (so that the elements of the subgroup can be expressed as words in the subgroup generators). From these two files MAF then constructs the coset rewriting system, and this is used as the input file actually processed for computations involving the subgroup. Since there are several different types of coset system, we shall defer discussion of the nature of the substructure files until later in this section.
</p>
<p>In order to process a coset system with <tt>automata</tt> or another MAF utility, the user will normally specify the command line option <kbd>-cos</kbd>. A further command line parameter, indicating the suffix used for the substructure file may also need to be specified. MAF follows KBMAG in insisting that all substructure files should have the same basename as the input file describing the group.</p>
<h3>Coset system basics</h3>
<p><em>From now on <i>G</i> will denote a group (or monoid) defined by a rewriting system in an input file, and <i>H</i> will be the subgroup of <i>G</i> in which we are currently interested.</em></p>
<p>MAF supports three different types of coset system, but before we can explain the differences between them,  we first need to introduce term <i>coset equation</i>, and to do this we need to describe some general features of MAF's coset systems, and to point out an important difference from an ordinary rewriting system.</p>
<p>In a rewriting system for <i>G</i> all the equations represent true equations between group elements. However, in a coset system an equation may represent either an equation between elements (of either the group or the subgroup), or an equation between cosets of elements, or <em>possibly both</em>. In order to understand the meaning of the equations appearing in a coset system we must learn to distinguish between various different types of generator, word and equation that may appear in the system.</p>
<h4>Generators of coset systems</h4>
<p>There are up to three types of generator in a coset rewriting system:</p>
<ol><li>The <dfn><i>G</i>-generators</dfn>, which are the generators of <i>G</i> coming from the original input file for <i>G</i>. These are always present.</li>
<li>The <dfn>coset symbol</dfn> (usually either <code>_H</code> or <code>_N</code>), which, is a new, non-invertible generator that represents the subgroup <i>H</i> as a whole. This generator is always present in a coset system.</li>
<li>Finally, and optionally, the <dfn><i>H</i>-generators</dfn>, which are all distinct from the <i>G</i>-generators (even when some of the subgroup generators are also group generators), and which are independent names for the generators of the subgroup <i>H</i>.</li>
</ol>
<h4>Words appearing in coset systems</h4>
<p>The words in these generators are now divided into four types:</p>
<ol><li>The empty word (denoted as usual by <code>IdWord</code>)</li>
    <li>Words in the G-generators alone (<dfn>G-words</dfn>)</li>
    <li>Words in the H-generators alone (<dfn>H-words</dfn>)</li>
    <li>"Mixed" words - all other words in these generators.</li>
</ol>
<p>The empty word is, uniquely, both a <i>G</i>-word and an <i>H</i>-word.</p>
<p>A mixed word may only appear in a coset system if it has the form <i>u*x*v</i> where <i>u</i> is an <i>H</i>-word (possibly empty), <i>x</i> is the coset symbol, and <i>v</i> is a <i>G</i>-word (possibly empty).</p>
<h4>Equations appearing in coset systems</h4>
<p>The LHS and RHS of any equation appearing in a coset system must be words of the same type. Thus there are three types of equation in a coset system:</p>
<ol><li>Equations between <i>G</i>-words. All such equations are true as equations between elements of <i>G</i>.
<li>Equations between <i>H</i>-words. Of course these are only present if there are <i>H</i>-generators. All such equations are true as equations between elements both of <i>G</i> and <i>H</i>.</li>       
<li>Finally, and most importantly, the equations involving mixed words, which are the <dfn>coset equations</dfn>. In all these the coset symbol necessarily appears on both sides of the equation. Coset equations always represent equations between cosets, but whether or not they also represent equations between elements of <i>G</i> depends on the type of the coset system.</li>
</ol>
<p>Coset equations in the input file generated for a coset system will all have the form <i>x*w=h*x</i> where <i>x</i> is the coset symbol, <i>w</i> is one of the subgroup generators listed in the substructure file, and <i>h</i> is either the corresponding <i>H</i>-generator or the empty word (if <i>H</i>-generators are not present). Usually the equations in output files will take the form <i>x*u=h*x*v</i> where <i>u</i> and <i>v</i> are different <i>G</i>-words, and <i>h</i> is some (possibly empty) <i>H</i>-word. However, other types of coset equation are possible if <i>G</i> is a monoid, or if the subgroup generators are named but do not have named inverses.</p>
<p>An input file created for a coset system by MAF will always be valid. If you choose to edit/create a coset system input file manually, but do not follow this pattern, then MAF will either refuse to treat the file as a coset system, or it may even refuse to process it altogether. In either case diagnostics will be issued so that the location of the violation can be determined.</p>
<h4>Word-ordering for coset systems</h4>
<p>The word-ordering options for coset systems are much more restricted than they are for input files for groups and monoids. In MAF a coset system will use either <code>"wreathprod"</code>, <code>"coset"</code>, or <code>"rt_wreathprod"</code> ordering. The word-ordering will be generated automatically based on the ordering given in the base input file for the group. Even though the ordering method in the coset system appears to be different from the original input file, the actual ordering of the <i>G</i>-words will be the same as for the original input file, so long as the original ordering was one of <code>"shortlex"</code>, <code>"recursive"</code>, <code>"rt_recursive"</code>, <code>"wreathprod"</code>, or <code>"rt_wreathprod"</code>. In all other cases the ordering of the <i>G</i>-words is changed. MAF will issue a warning if this happens.</p>
<p>More flexible word-ordering support will be added to coset systems in future.</p>
<h3>The three types of coset system</h3>
<p>We are now ready to describe the three types of coset system. The first two types are also supported by KBMAG (with limitations), but the third type is new to MAF.</p>
<ol><li><a name="simple"></a><h4>Simple coset systems</h4>
<p>In the first type of coset system, called a <dfn>simple coset system</dfn>, a coset equation is an equation of the form. <i>H*u=H*v</i>, and means that the set of of all elements of the form <i>h</i>*<i>u</i> and the set of all elements of the form <i>h</i>*<i>v</i> are equal as sets, where in each case <i>h</i> denotes a member of <i>H</i>. Obviously such an equation does not imply that <i>u</i>=<i>v</i>. In fact equations of this type appear in the coset system in the form <code>[_H*u,_H*v]</code> where <code>_H</code> is the coset symbol.</p>
<p>Computations with this type of coset system are often much easier than for the next.</p>
</li>
<li><h4><a name="named"></a>Coset systems with named subgroup generators</h4>
<p>In the second type of coset system, called a <dfn>coset system with named subgroup generators</dfn>, we express our coset equations differently: in the case where <i>H*u=H*v</i> is true as a coset equation in the sense just explained, we will then find a specific <i>h</i> such that <i>u=h*v</i> and then write the coset equation as <i>H*u=h*H*v</i>. This obviously implies our first form of the coset equation, and if we remove the <i>H</i> on both the LHS and the RHS, we are left with a true equation of words in the group. Now coset equations appear in the coset system in the form <code>[_H*<i>u</i>,<i>h</i>*_H*<i>v</i>]</code> where <i>u</i> and <i>v</i> are words in the original group generators, and <i>h</i> is a word in the named subgroup generators. Although <code>_H</code> is non-invertible it cancels on the right. This is very important as this is the main method by which equations in the <i>H</i>-generators alone will be discovered.</p>
<p>The main benefits of using this type of coset system are:
<ol><li>A subgroup presentation can be computed using the specified subgroup generators.</li>
<li>Each element of the group can be expressed in the form <i>h</i>*<i>v</i> where <i>h</i> is a subgroup member and <i>v</i> is a canonical coset representative.</li>
</ol>
<p>Despite these benefits, a simple coset system may well give better results in practice. This is likely where the subgroup has a very large number of generators. In addition, it can happen that the <i>H</i>-words appearing in the prefix of the RHS of coset equations become extremely long, and in this case it is also usually better to use one of the other types of coset system. Alternatively you can try to add some redundant subgroup generators in the hope of reducing the length of such words. Unless you want to generate a presentation for the subgroup using a specific set of generators, it is sometimes best to avoid coset systems with named subgroup generators.
<li><h4><a name="normal"></a>Normal closure coset systems</h4>
<p>The third type of coset system is very similar to the first. However, in a coset system of this type, the subgroup is assumed to be normal. Therefore, whenever a coset equation of the form <i>H*u=H*v</i> is found MAF will deduce that all words of the form <i>g*u*v^-1*g^-1</i> are elements of the subgroup. The advantage of using this type of coset system, which is called a <dfn>normal closure coset system</dfn> is that you do not have to know in advance a complete generating set for the subgroup. However, this option must be used with caution, because it could easily happen that the normal closure of a subgroup is not finitely generated, and in this case MAF has no hope of success.</p>
<p>In this type of coset system coset equations take the form <code>[_N*<i>u</i>,_N*<i>v</i>]</code> where <code>_N</code> is now used as the coset symbol instead of <code>_H</code>.</p>
<p>This type of coset system is often useful for determining a finite generating set for a normal subgroup, and is convenient for computing a presentation of the subgroup corresponding to a finite-index quotient. Once a finite generating set has been found you can, if you wish, create a corresponding coset system with named subgroup generators.</p>
</li>
</ol>
<h3>Creating a coset system</h3>
<p class="xpanel">Cosets of submonoids of monoids do not in general behave in a manner suitable for use with coset systems (or much else for that matter). For example, if <i>L</i> is a submonoid of <i>M</i> and <i>x</i> &isin; <i>L</i>, then it does not even follow that <i>L*x=L</i> - it may be a proper subset of <i>L</i>: as an example consider the monoid of positive integers under multiplication, and any submonoid of the form {<i>N*n</i> &cup; 1}.</p>
<p>We have already mentioned that a coset system is usually generated automatically from the input file for <i>G</i>, and a substructure file describing <i>H</i>, so before we can start using coset systems we must learn how to produce the substructure files they will be built from. This seems to be an appropriate time to point out that a substructure file should always describe a <strong>subgroup</strong>, even if the original input file is for a <strong>monoid</strong>, because the notion of cosets is somewhat meaningless for <em>submonoids</em> (as is explained in the side panel). So substructure files might also be referred to as a subgroup file, even though, in the case of a monoid, it would be up to the user to verify that the given set of substructure generators did in fact generate a group and not just a monoid. (This will certainly be true if the subgroup generators are words in generators of <i>G</i> for which an inverse was specified). </p>
<p>It is suggested that the reader refers to <a href="substructure_files.html">MAF: Reference: Substructure files</a> at this point.</p>

<h3>Computations for coset systems available in MAF</h3>
<p>All the programs in MAF work equally well with rewriting systems that define groups or monoids, and with coset rewriting systems. So here we merely introduce programs and details that were not relevant when considering the use of <tt>automata</tt> to solve the word problem for groups and monoids. Usually this just means starting the relevant component of MAF with a command line option of <kbd>-cos</kbd>, and possibly an explicit subgroup suffix (in the case where your substructure file is not called simply <tt><i>groupname</i>.sub</tt>, or as described in <a href="coset_system_names.html">Coset system filenames</a>, you can simply supply the program with the full name of the coset system file if you prefer, provided the coset system has been created already.</p>
<h4><tt>gpsublowindex</tt> and <tt>gpsubmake</tt></h4>
<p>The <a href="gp_usage.html#gpsublowindex"><tt>gpsublowindex</tt></a> utility can be used to search for subgroups up to a given index, and so can actually create substructure files for you. The <a href="gp_usage.html#gpsubmake"><tt>gpsubmake</tt></a> utility can be used to create substructure files for the derived subgroup and power subgroups (the subgroup generated by all elements of the form <i>g<sup>n</sup></i> for some <i>n</i>).</p>
<h4><tt>gptcenum</tt></h4>
<p>This is probably a good time to point out that MAF can now also perform coset enumeration using coset systems. This is done using the program <a href="gp_usage.html#gptcenum"><tt>gptcenum</tt></a> rather than <tt>automata</tt>. Coset enumeration is only possible for finite index subgroups, but in this case it will often, though by no means always, be a faster way of verifying that a subgroup has finite index than using <tt>automata</tt>. Currently <tt>gptcenum</tt> can only compute a coset table (which can be used to perform word reduction), a coset word-acceptor, and a subgroup presentation on Schreier generators. More facilities will probably be added to <tt>gptcenum</tt> in future releases, and it is possible that it will be enhanced at some point to understand either ACE input files, or the GAP files used with the GAP ACE interface.</p>
<h4><tt>automata</tt></h4>
<p>The aim of <tt>automata</tt>, when used with a coset system, is either to find a confluent rewriting system for it, or to generate an automatic structure for it, or preferably both. There are only a few differences in the operation and use of <tt>automata</tt> from what was described in <a href="automata.html">MAF: Computations on whole groups and monoids</a>. As before, either, neither, or both of these structures may exist. However, there are a few new features:</p>
<ul>
<li>In the case of finite index subgroups, it is possible to get <tt>automata</tt> to stop when it has found a rewriting system that is "partially confluent". Refer to <a href="#partialconfluence">Confluent and partially confluent coset systems</a> below for further information about this.</li>
<li><tt>automata</tt> will also perform some additional computations for a coset system that have no counterpart in an ordinary rewriting system: 
<ul><li>If the subgroup has finite index, and has sufficiently small index, the coset table is computed.</li>
<li>It will attempt to compute a presentation of the subgroup, either on Schreier generators (when the subgroup generators are not named), or on the named subgroup generators (when they are).</li>
<li>If an automatic structure has been computed for the group, <tt>automata</tt> will attempt to compute a word-acceptor which accepts precisely those words which are accepted by the word-acceptor for <i>G</i> and which are elements of <i>H</i>. This automaton will also be computed if a word-acceptor for the group has been computed and the subgroup has finite index and the coset table has been computed, whether or not an automatic structure has been computed.
</li></ul>
</li>
</ul>
<h4><a name="partialconfluence"></a>Confluent and partially confluent coset systems</h4>
<ul><li><p>If the output coset system system is confluent in the strict sense, then the various types of equation present in a coset system will be confluent individually in the following sense.</p>
<ol>
<li> The <i>G</i>-equations will form a confluent system for <i>G</i>, just as they would if <tt>automata</tt> had been run on the original rewriting system for <i>G</i>. 
<li> The equations involving the coset symbol <i>_H</i> together with the <i>G</i>-equations will be sufficient to reduce any word of the form <code>_H*<i>w</i></code>, with <i>w</i> a word in the <i>G</i>-generators, to <code>_H*<i>w&prime;</i></code> (or <code><i>h</i>*_H*<i>w&prime;</i></code> if <i>H</i>-generators are present), where <i>w&prime;</i> is the least word (under the ordering being used) in the <i>G</i>-generators that lies in the coset <i>Hw</i>. If <i>H</i>-generators are present, then the equation <i>w = h*w&prime;</i> is a true equation in <i>G</i>, and <i>h</i> is the least word in the <i>H</i>-generators for the corresponding element of the subgroup.
<li>The <i>H</i>-equations, if present, will form a confluent rewriting system for <i>H</i> (and so we shall, in particular, have computed a (probably highly redundant) presentation for the subgroup <i>H</i>).</li>
</ol>
<p>A confluent rewriting system for a coset system may well contain a great deal of information that is not required in order to find the coset representative of any group element. For, example in the extreme case of a subgroup of index 1, we do not need any <i>G</i>-equations at all to find the coset representative of a group element.</p></li>
<li><p>In a "partially confluent" coset system, neither the <i>G</i>-equations, nor the <i>H</i>-equations (if present) are necessarily confluent (though it is possible that either one or the other set might be). However, the set of equations is confluent in so far as for any <i>G</i>-word <i>u</i>, the least element of the coset containing <i>u</i> (in the reduction ordering), can be found unambiguously by rewriting the word <i>_H*u</i> where <i>_H</i> is assumed to be the coset symbol for the system. However, if subgroup generators are named, the <i>H</i>-word appearing in the reduced word for <i>_H*u</i> might not be irreducible.</p></li>
</ul>
<p>MAF can recognise this limited type of confluence when either the <kbd>-detect_finite_index</kbd> or <kbd>-prove_finite_index</kbd> option is supplied to <tt>automata</tt>. It arises when the <i>_H</i> language is finite (the subgroup has finite index), and all overlaps of the <i>G</i>- and <i>_H</i>- equations which are needed to reduce words of the form <code>_H*<i>w*g</i></code> where <i>w</i> is a coset representative are locally confluent. The <code>H</code>-equations, if present, are not relevant, because no attention is paid to the <i>H</i>-words appearing on the RHS of coset equations in this situation. If MAF outputs such a coset system, it will be given the usual <tt>.kbprog</tt> suffix, but the "<code>isConfluent := true</code>" field normally found in such output files will be missing.</p>
<p>For coset systems with named subgroup generators the command line options <kbd>-no_h</kbd> and <kbd>-ignore_h_length</kbd> are frequently useful. Surprisingly, the subgroup presentations that are generated by MAF are often better (i.e. smaller), when the <kbd>-no_h</kbd> option is used, than when it is not.</p> 
<p>For full details of all thse options refer to <a href="automata_usage.html#coset_system_options">Options for coset systems</a>.</p>
<h4>Automatic structures for coset systems</h4>
<p>It is difficult to know whether an automatic coset structure does actually exist for a coset system: it is neither a necessary nor a sufficient condition that an automatic structure exists for the whole group, though it is certainly more likely that MAF will succeed in finding such an automatic coset structure if an automatic structure for the group has already been found. Of course, a coset system for a subgroup of finite index is always automatic.</p>
<p>In order for an automatic coset structure to exist the the set of all word-differences arising from the <i>G</i>-word and coset equations required for reducing words to the coset representative  must be finite. (Word-differences are not computed for <i>H</i>-word equations). For this to be the case it must also be true that the set of all words <i>h</i> in <i>H</i> that occur in the rewriting equations of the form <kbd>[_H<i>*u</i>,<i>h</i>*_H*<i>v</i>]</kbd> must also be finite, since these words appear as initial states of the word-difference machine. (Even if H-words are not present in the coset system, the initial states will be different if different subgroup elements are required to make the coset equation true as a group equation)</p>
<h4>Subgroup presentations</h4>
<p>If MAF succeeds in finding an automatic coset structure for a coset system then it is possible to compute a presentation of the subgroup described by the substructure file whether or not the subgroup has finite index.
It is also possible to compute a subgroup presentation if the subgroup has finite index, even if an automatic coset structure is not computed, or if the coset system is confluent and uses named subgroup generators (whether or not the subgroup has finite index).</p>
<p><tt>automata</tt> always computes a subgroup presentation if it is possible to do so. It outputs two files for the presentation, a file with the suffix <tt>.rws</tt>, which is an ordinary input file for the group described by the substructure file, and a file with the suffix <tt>.pres</tt>, which is a file containing GAP source code that creates the group as a <code>FpGroup</code>. This file is primarily created for compatibility with KBMAG. It can be processed with GAP's Tietze transformation functions, but you will probably find it more convenient to use MAF's <tt>simplify</tt> program against the <tt>.rws</tt> file instead.</p>
<p>It is sometimes convenient to be able to perform the computation of a subgroup presentation separately, and you can use the utility <a href="gp_usage.html#gpsubpres"><tt>gpsubpres</tt></a> to do this. For example, you might have used a coset system with named subgroup generators, only to find that the equations in the subgroup presentation are horribly long, so that it might be better to have a presentation on Schreier generators. Or, you might have edited the file containing the presentation, or run <tt>simplify</tt> against it, and then found you wanted to recover the original presentation. Occasionally it might happen that the subgroup presentation takes a very long time to compute, and you might decide to interrupt <tt>automata</tt> and try to compute it using <tt>gpsubpres</tt> with new options.</p>
<p>The KBMAG work-alike <tt>autcos</tt> only computes a subgroup presentation if the <tt>-p</tt> option is specified, and only in the GAP source code format, and only when an automatic structure is computed. As noted elsewhere this presentation will always be on Schreier generators: the information needed to compute a presentation on the user generators is missing from the automatic structures created by <tt>autcos</tt>.</p>
<p>In fact the presentations produced by MAF will not be usually be very redundant (at least for low index subgroups) and in fact for simple examples may form an independent set of axioms for the subgroup. For subgroups with a high index the number of generators can be very high if Schreier generators are used: for example, while investigating the group in <tt>examples/unknown/g9(1_3)</tt>, whose order is unknown, the author tried to compute a presentation of a subgroup of index 9576, which is known to be a perfect group. There are fairly small generating sets for this subgroup, but it does not seem to be at all easy to calculate a presentation using them: using named generators results in a coset system which quickly produces unmanageably large equations. With unnamed generators the coset multiplier and table can be found quickly, but a presentation computed on the Schreier generators has in excess of 17000 generators.</p>

<h3>Creating subgroup word-acceptors</h3>
<p>A <dfn>subgroup word-acceptor</dfn> for a subgroup <i>H</i> of a group <i>G</i> is a finite state automaton with alphabet equal to the monoid generating set for <i>G</i>, which accepts precisely those words that lie in <i>H</i> and are accepted by the word-acceptor for <i>G</i>. Thus they accept a unique word for each element of <i>H</i>. If such an acceptor can be constructed then an arbitrary word in the <i>G</i>-generators can then be tested for membership in <i>H</i> by first reducing it to its <i>G</i>-normal form (using <tt>reduce</tt>) and then testing for acceptance by the word-acceptor for <i>H</i>. Thus the membership problem can be solved for <i>H</i>. MAF creates such word-acceptors by first creating a "membership" FSA which tries to decide this question for an arbitrary word (this FSA is similar to a coset table constructed by a Todd-Coxeter coset enumeration). However, this latter membership FSA can only ever be correct if the index of the subgroup is finite (because otherwise it would have to have an infinite number of states). In the infinite case, for some words this FSA will reach the failure state, which means the coset for the word is unknown (though it would be possible to find it if the coset rewriting system is either confluent or automatic). Yet, it may happen that when we restrict ourselves to considering the language, <i>L<sub>0</sub></i>, of reduced words of <i>G</i>, that we may be able to create a more limited membership FSA that says whether an irreducible word is in the subgroup (and this is the subgroup word-acceptor), because it may be the case that the set of all cosets corresponding to prefixes of irreducible words that are members of the subgroup is finite. This set, which we shall call  <i>C<sub>H</sub></i> = {<i>H*w(i)</i> : <i>w</i> &isin; <i>L<sub>0</sub></i> and <i>w</i> &isin; <i>H</i> and i &isin; <b>N</b>} (where w(i) denotes the prefix of length <i>i</i> of <i>w</i> or <i>w</i> if <i>i</i> &gt; <i>l(w)</i>. In this case we can construct a subgroup word-acceptor by "anding" the word-acceptor for the group with a suitably large provisional "membership" FSA. Indeed it is not to hard to prove that this is both a necessary and sufficient condition for the subgroup word-acceptor to exist, given the existence of a word-acceptor for <i>G</i> in the first place.</p>
<p>Even so, whether or not we can construct such a word-acceptor is rather a tricky question in practice. Even if we have successfully computed a confluent or an automatic structure for a coset system, (in which case we certainly can compute whether a reduced word <i>w</i> lies in <i>H</i>, by the simple expedient of reducing <code>_H*<i>w</i></code>), we might not be able to construct the desired FSA, because the set <i>C<sub>H</sub></i> might not in fact be finite. Conversely, even when we cannot find a confluent or an automatic structure for a coset system, then, at least in the case where <i>G</i> was automatic, if <i>C<sub>H</sub></i> is finite, we can construct the subgroup word-acceptor, through the use of a suitable large provisional coset rewriting system.</p>
<p>Theoretically, if <i>G</i> is automatic, and an automatic structure has previously been computed, then this method will work precisely when <i>H</i> is a quasiconvex subgroup of <i>G</i>. The algorithm used for constructing a subgroup word-acceptor is as follows:</p>
<ol type="i">
<li><p>If the subgroup has sufficiently small finite index construct the coset table and and this with the word-acceptor for the group. In this case there is nothing further to be done.
<li><p>Otherwise, construct the general multiplier in the group <i>G</i> for the subgroup generators of <i>H</i>. (We can always do this since <i>G</i> is automatic). Let us call this FSA <i>GM<sub>GH</sub></i>.</p></li>
<li><p>Construct a "membership" FSA <i>M<sub>H</sub></i> which we hope can recognise all the cosets <i>C<sub>H</sub></i>.</p></li>
<li><p>Then construct a candidate subgroup word-acceptor <i>W<sub>H</sub></i> by "anding" <i>M<sub>H</sub></i> with the the word-acceptor, <i>W<sub>G</sub></i>, for the group.</li>
<li><p>Clearly <i>W<sub>H</sub></i> should be closed under the multiplication in <i>G</i> defined by <i>GM<sub>GH</sub></i>. So we construct a candidate general multiplier in <i>H</i> by intersecting <i>GM<sub>GH</sub></i> and <i>W<sub>H</sub></i>, and this should contain an accept state for every word accepted by <i>W<sub>H</sub></i> and every sub-generator. In fact it should contain such an accept state whether we form either the "left" or the  "right" "exists" FSA for the multiplier. If it does not, then we can find one or more <i>G</i>-reduced words that are in <i>H</i> but are not accepted by <i>W<sub>H</sub></i>, which means that our <i>M<sub>H</sub></i> did not have a big enough language. We then return to step ii), and use these words to improve <i>M<sub>H</sub></i>.</p></li>
<li><p>If, as we hope, <i>C<sub>H</sub></i> really is finite, then eventually this process will terminate, and not only have we found the subgroup word-acceptor, we have found a multiplier for it, and so have proved that the language it accepts really does define a subgroup.</p></li>
</ol>
<p>When <tt>automata</tt> is attempting to analyse a coset system, its primary aim is to find a confluent rewriting system or automatic structure for it. In the latter case if it succeeds in doing so, it will then attempt to construct a subgroup word-acceptor, using the algorithm described, provided the automatic structure for G has previously been computed. However, in other cases it does not do. The program <tt>gpsubwa</tt> can be used to attempt to construct a subgroup word-acceptor in the case were <tt>automata</tt> only found a provisional (or possibly a confluent) coset rewriting system, but <i>G</i> itself already does have an automatic structure.</p>

<h3>KBMAG compatibility issues for coset systems</h3>
<h4>Word-ordering</h4>
<p>In KBMAG's implementation of coset systems, use of "wreathprod" ordering is mandated. The intention behind this is to ensure that all equations produced by Knuth-Bendix completion will take the desired form: <code>[_H*<i>u</i>,<i>h</i>*_H*<i>v</i>]</code>. This is the case if the original input rewriting system uses <code>"shortlex"</code> ordering.
However, if "recursive" ordering is used, then <code>"wreathprod"</code> ordering does not work. The file <tt>ab2_recursive</tt> in the <tt>examples/subgroups</tt> directory demonstrates this. KBMAG's <tt>kbprogcos</tt> will not work properly with the coset system at all. This happens because in wreath product ordering h*_H*b is greater than _H*b*a. KBMAG assumes it can move the  <i>H</i>-word from the LHS to the RHS of this equation, when clearly it cannot. KBMAG should not allow coset systems to based on input rewriting systems that do not use "shortlex" ordering.</p>
<p>KBMAG would also change <code>"rt_recursive"</code> ordering in the original input file to <code>"wreathprod"</code> ordering in the coset system. This gives a different ordering of <i>G</i>-words, whereas MAF will change the ordering to an identical <code>"rt_wreathprod"</code> ordering. So, in general, it is unwise to attempt to use coset systems created by KBMAG in MAF. Instead the coset system should be regenerated. (This would usually happen automatically, unless you specify an explicit coset system filename rather than relying on the <kbd>-cos</kbd> option).</p>
<p>MAF is able to deal this problem: it does this by examining the level field of the coset system. If it determines that problems with word-ordering will arise then it silently changes the ordering method from <code>"wreathprod"</code> to <code>"coset"</code>. This is an ordering method new to MAF which works as follows: to compare two words  <i>u</i>,<i>v</i> first split each word into its initial <i>H</i>-word and its final <i>G</i>-word. First compare the <i>G</i>-words. If these are not equal then their ordering determines the ordering of the whole word. If the <i>G</i>-words are equal parts compare the <i>H</i>-words.</p>
<p>This approach would work for any method of ordering <i>G</i>-words and <i>H</i>-words, so MAF could in principle be much more flexible in the range of word-ordering methods it supports for coset rewriting systems. It is the author's intention to support this in future.</p>
<p>The problems that arise when the original input file uses <code>"recursive"</code> or <code>"wreathprod"</code> ordering do not arise with the <code>"rt_recursive"</code> and <code>"rt_wreathprod"</code> orderings, because ties between equal high level words are decided on the right rather than the left.
<h4>Automatic structures</h4>
<p>MAF can compute automatic structures for any type of coset system (unlike KBMAG, which only supports them for coset systems with named subgroup generators), and can also generate a subgroup presentation and subgroup word-acceptor equally well with any kind of coset system.</p>
<h4>Subgroup presentations</h4>
<p>KBMAG cannot compute a subgroup presentation on the specified subgroup generators, even when they are named. This limitation also applies if you use MAF's <tt>autcos</tt> or <tt>autgroup</tt> to create an automatic coset structure. Even if you then invoke <tt>gpsubpres</tt> separately any subgroup presentation computed from such an automatic structure will be on Schreier generators, because the information required to compute a presentation on the named subgroup generators is missing from the automatic structure.
</p>
<h3>Examples of Knuth-Bendix on coset rewriting systems</h3>
<p>The <tt>examples/subgroups</tt> directory contains a number of examples of rewriting systems for groups together with some defined subgroups.</p>
<p><tt>examples/wallpaper</tt> contains a presentation of the 244 (or more accurately, in terms of the presentation used, the 424) triangle group, together with subgroup files for each of the crystallographic wallpaper groups which occur as its subgroups - these can be used to generate nice presentations of each of these groups: there is at least one subgroup file for each group that will generate a confluent and automatic presentation. There is a similar set of presentations of the wallpaper groups which occur as subgroups of the 236 triangle subgroup.</p>
<p><tt>examples/hyperbolic</tt> contains some subgroup files which work with many different hyperbolic triangle groups. These can be used to find analogous subgroups to some of the Euclidean wallpaper groups.
</p>
</body>
</html>
